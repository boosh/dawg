#cloud-config
ssh_keys:
  ecdsa_public: ${ecdsa_public}
  ecdsa_private: |
    ${indent(4, ecdsa_private)}
package_update: true
package_upgrade: true
packages:
- wireguard
- resolvconf
- qrencode
write_files:
- encoding: b64
  content: ${wg_configure_server}
  owner: root:root
  path: /usr/local/bin/wg-configure-server.sh
  permissions: '0755'
- encoding: b64
  content: ${wg_add_client}
  owner: root:root
  path: /usr/local/bin/wg-add-client.sh
  permissions: '0755'
runcmd:
- [ufw, allow, 22/tcp]
- [ufw, enable]
- [/usr/local/bin/wg-configure-server.sh]
power_state:
  mode: reboot
  message: Rebooting
  condition: True
